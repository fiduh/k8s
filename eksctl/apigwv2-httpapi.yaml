apiVersion: apigatewayv2.services.k8s.aws/v1alpha1
kind: API
metadata:
  name: "ack-api"
spec:
  name: "ack-api"
  protocolType: HTTP
  corsConfiguration:
    allowHeaders:
      - content-type
    allowMethods:
      - "*"
    allowOrigins:
      - "*"

---

apiVersion: apigatewayv2.services.k8s.aws/v1alpha1
kind: Integration
metadata:
  name: "private-nlb-integration"
spec:
  apiRef:
    from:
      name: "ack-api"
  integrationType: HTTP_PROXY
  integrationURI: "arn:aws:elasticloadbalancing:us-east-1:619071319195:listener/net/k8s-default-ciliumga-3bdee2b502/58f96d518dc35b76/f6c9e764d4d6658d"
  integrationMethod: "ANY"
  connectionType: VPC_LINK
  connectionID: "rbi3gf"
  payloadFormatVersion: "1.0"
  passthroughBehavior: WHEN_NO_MATCH
  requestParameters:
    overwrite:path: "/"
    


---

apiVersion: apigatewayv2.services.k8s.aws/v1alpha1
kind: Route
metadata:
  name: "ack-api"
spec:
  apiRef:
    from:
      name: "ack-api"
  routeKey: "ANY /"
  targetRef:
    from:
      name: "private-nlb-integration"

---


apiVersion: apigatewayv2.services.k8s.aws/v1alpha1
kind: Stage
metadata:
  name: "dev"
spec:
  apiRef:
    from:
      name: "ack-api"
  stageName: "dev"
  autoDeploy: true
  description: "auto deployed stage for ack-api"
